<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Supabase Member Insert Debug</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
</head>
<body>
  <h2>Add Member (Debug)</h2>
  <form id="memberForm">
    <label for="name">Full Name:</label>
    <input type="text" id="name" required /><br /><br />

    <label for="email">Email:</label>
    <input type="email" id="email" required /><br /><br />

    <button type="submit">Submit</button>
  </form>

  <pre id="debugOutput" style="background: #f0f0f0;padding:10px;border:1px solid #ccc;"></pre>

  <script>
    // Initialize Supabase
    const supabaseUrl = 'https://duzwecymsheosedmfksz.supabase.co'; // Your project URL
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR1endlY3ltc2hlb3NlZG1ma3N6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4MjgyNjQsImV4cCI6MjA4NjQwNDI2NH0.GM0Q5-uRPAmij0I_8NLQUBrqY7jM_JCNFFX06w_b5UQ'; // Your anon key
    const supabase = window.supabase.createClient(supabaseUrl,supabaseKey);

    const form = document.getElementById('memberForm');
    const debugOutput = document.getElementById('debugOutput');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();

      if (!name || !email) {
        debugOutput.textContent = 'Please fill in all fields.';
        return;
      }

      debugOutput.textContent = 'Submitting...';

      try {
        // Insert with debug info
        const { data, error, status, statusText } = await supabase
          .from('members')
          .insert([
            {
              full_name: name,
              email: email,
              verification_status: 'pending',
              role: 'member'
            }
          ], { returning: 'minimal' }); // Prevent implicit SELECT

        debugOutput.textContent = JSON.stringify({
          status,
          statusText,
          data,
          error
        }, null, 2);

        if (!error) {
          debugOutput.textContent += '\n\nâœ… Member added successfully!';
          form.reset();
        }

      } catch (err) {
        debugOutput.textContent = `Unexpected error:\n${err.message}`;
      }
    });
  </script>
</body>

</html>

